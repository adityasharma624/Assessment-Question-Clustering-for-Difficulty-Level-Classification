{
  "basic": {
    "title": "Monthly Transactions I",
    "titleSlug": "monthly-transactions-i",
    "frontendQuestionId": 1317,
    "acRate": null,
    "difficulty": {
      "level": 2
    },
    "paidOnly": false,
    "isFavor": false,
    "status": null
  },
  "detail": {
    "questionId": "1317",
    "title": "Monthly Transactions I",
    "titleSlug": "monthly-transactions-i",
    "content": "<p>Table: <code>Transactions</code></p>\n\n<pre>\n+---------------+---------+\n| Column Name   | Type    |\n+---------------+---------+\n| id            | int     |\n| country       | varchar |\n| state         | enum    |\n| amount        | int     |\n| trans_date    | date    |\n+---------------+---------+\nid is the primary key of this table.\nThe table has information about incoming transactions.\nThe state column is an enum of type [&quot;approved&quot;, &quot;declined&quot;].\n</pre>\n\n<p>&nbsp;</p>\n\n<p>Write an SQL query to find for each month and country, the number of transactions and their total amount, the number of approved transactions and their total amount.</p>\n\n<p>Return the result table in <strong>any order</strong>.</p>\n\n<p>The query result format is in the following example.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example 1:</strong></p>\n\n<pre>\n<strong>Input:</strong> \nTransactions table:\n+------+---------+----------+--------+------------+\n| id   | country | state    | amount | trans_date |\n+------+---------+----------+--------+------------+\n| 121  | US      | approved | 1000   | 2018-12-18 |\n| 122  | US      | declined | 2000   | 2018-12-19 |\n| 123  | US      | approved | 2000   | 2019-01-01 |\n| 124  | DE      | approved | 2000   | 2019-01-07 |\n+------+---------+----------+--------+------------+\n<strong>Output:</strong> \n+----------+---------+-------------+----------------+--------------------+-----------------------+\n| month    | country | trans_count | approved_count | trans_total_amount | approved_total_amount |\n+----------+---------+-------------+----------------+--------------------+-----------------------+\n| 2018-12  | US      | 2           | 1              | 3000               | 1000                  |\n| 2019-01  | US      | 1           | 1              | 2000               | 2000                  |\n| 2019-01  | DE      | 1           | 1              | 2000               | 2000                  |\n+----------+---------+-------------+----------------+--------------------+-----------------------+\n</pre>\n",
    "difficulty": "Medium",
    "likes": 1281,
    "dislikes": 126,
    "isPaidOnly": false,
    "sampleTestCase": "{\"headers\":{\"Transactions\":[\"id\",\"country\",\"state\",\"amount\",\"trans_date\"]},\"rows\":{\"Transactions\":[[121,\"US\",\"approved\",1000,\"2018-12-18\"],[122,\"US\",\"declined\",2000,\"2018-12-19\"],[123,\"US\",\"approved\",2000,\"2019-01-01\"],[124,\"DE\",\"approved\",2000,\"2019-01-07\"]]}}",
    "codeSnippets": [
      {
        "lang": "MySQL",
        "langSlug": "mysql",
        "code": "# Write your MySQL query statement below\n"
      },
      {
        "lang": "MS SQL Server",
        "langSlug": "mssql",
        "code": "/* Write your T-SQL query statement below */\n"
      },
      {
        "lang": "PostgreSQL",
        "langSlug": "postgresql",
        "code": "-- Write your PostgreSQL query statement below\n"
      },
      {
        "lang": "Oracle",
        "langSlug": "oraclesql",
        "code": "/* Write your PL/SQL query statement below */\n"
      },
      {
        "lang": "Pandas",
        "langSlug": "pythondata",
        "code": "import pandas as pd\n\ndef monthly_transactions(transactions: pd.DataFrame) -> pd.DataFrame:\n    "
      }
    ],
    "topicTags": [
      {
        "name": "Database",
        "slug": "database",
        "translatedName": null
      }
    ],
    "stats": "{\"totalAccepted\": \"459.3K\", \"totalSubmission\": \"782.9K\", \"totalAcceptedRaw\": 459276, \"totalSubmissionRaw\": 782924, \"acRate\": \"58.7%\"}",
    "similarQuestions": "[{\"title\": \"Monthly Transactions II\", \"titleSlug\": \"monthly-transactions-ii\", \"difficulty\": \"Medium\", \"translatedTitle\": null}]",
    "stats_parsed": {
      "totalAccepted": "459.3K",
      "totalSubmission": "782.9K",
      "totalAcceptedRaw": 459276,
      "totalSubmissionRaw": 782924,
      "acRate": "58.7%"
    },
    "similarQuestions_parsed": [
      {
        "title": "Monthly Transactions II",
        "titleSlug": "monthly-transactions-ii",
        "difficulty": "Medium",
        "translatedTitle": null
      }
    ]
  },
  "discussions_preview": [],
  "fetched_at": "2025-11-25T14:57:13.678988Z"
}