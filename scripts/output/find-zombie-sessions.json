{
  "basic": {
    "title": "Find Zombie Sessions",
    "titleSlug": "find-zombie-sessions",
    "frontendQuestionId": 4043,
    "acRate": null,
    "difficulty": {
      "level": 3
    },
    "paidOnly": false,
    "isFavor": false,
    "status": null
  },
  "detail": {
    "questionId": "4043",
    "title": "Find Zombie Sessions",
    "titleSlug": "find-zombie-sessions",
    "content": "<p>Table: <code>app_events</code></p>\n\n<pre>\n+------------------+----------+\n| Column Name      | Type     | \n+------------------+----------+\n| event_id         | int      |\n| user_id          | int      |\n| event_timestamp  | datetime |\n| event_type       | varchar  |\n| session_id       | varchar  |\n| event_value      | int      |\n+------------------+----------+\nevent_id is the unique identifier for this table.\nevent_type can be app_open, click, scroll, purchase, or app_close.\nsession_id groups events within the same user session.\nevent_value represents: for purchase - amount in dollars, for scroll - pixels scrolled, for others - NULL.\n</pre>\n\n<p>Write a solution to identify <strong>zombie sessions,&nbsp;</strong>sessions where users appear active but show abnormal behavior patterns. A session is considered a <strong>zombie session</strong> if it meets ALL the following criteria:</p>\n\n<ul>\n\t<li>The session duration is <strong>more than</strong> <code>30</code> minutes.</li>\n\t<li>Has <strong>at least</strong> <code>5</code> scroll events.</li>\n\t<li>The <strong>click-to-scroll ratio</strong> is less than <code>0.20</code> .</li>\n\t<li><strong>No purchases</strong> were made during the session.</li>\n</ul>\n\n<p>Return <em>the result table ordered by</em>&nbsp;<code>scroll_count</code> <em>in <strong>descending</strong> order, then by</em> <code>session_id</code> <em>in <strong>ascending</strong> order</em>.</p>\n\n<p>The result format is in the following example.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong></p>\n\n<p>app_events table:</p>\n\n<pre class=\"example-io\">\n+----------+---------+---------------------+------------+------------+-------------+\n| event_id | user_id | event_timestamp     | event_type | session_id | event_value |\n+----------+---------+---------------------+------------+------------+-------------+\n| 1        | 201     | 2024-03-01 10:00:00 | app_open   | S001       | NULL        |\n| 2        | 201     | 2024-03-01 10:05:00 | scroll     | S001       | 500         |\n| 3        | 201     | 2024-03-01 10:10:00 | scroll     | S001       | 750         |\n| 4        | 201     | 2024-03-01 10:15:00 | scroll     | S001       | 600         |\n| 5        | 201     | 2024-03-01 10:20:00 | scroll     | S001       | 800         |\n| 6        | 201     | 2024-03-01 10:25:00 | scroll     | S001       | 550         |\n| 7        | 201     | 2024-03-01 10:30:00 | scroll     | S001       | 900         |\n| 8        | 201     | 2024-03-01 10:35:00 | app_close  | S001       | NULL        |\n| 9        | 202     | 2024-03-01 11:00:00 | app_open   | S002       | NULL        |\n| 10       | 202     | 2024-03-01 11:02:00 | click      | S002       | NULL        |\n| 11       | 202     | 2024-03-01 11:05:00 | scroll     | S002       | 400         |\n| 12       | 202     | 2024-03-01 11:08:00 | click      | S002       | NULL        |\n| 13       | 202     | 2024-03-01 11:10:00 | scroll     | S002       | 350         |\n| 14       | 202     | 2024-03-01 11:15:00 | purchase   | S002       | 50          |\n| 15       | 202     | 2024-03-01 11:20:00 | app_close  | S002       | NULL        |\n| 16       | 203     | 2024-03-01 12:00:00 | app_open   | S003       | NULL        |\n| 17       | 203     | 2024-03-01 12:10:00 | scroll     | S003       | 1000        |\n| 18       | 203     | 2024-03-01 12:20:00 | scroll     | S003       | 1200        |\n| 19       | 203     | 2024-03-01 12:25:00 | click      | S003       | NULL        |\n| 20       | 203     | 2024-03-01 12:30:00 | scroll     | S003       | 800         |\n| 21       | 203     | 2024-03-01 12:40:00 | scroll     | S003       | 900         |\n| 22       | 203     | 2024-03-01 12:50:00 | scroll     | S003       | 1100        |\n| 23       | 203     | 2024-03-01 13:00:00 | app_close  | S003       | NULL        |\n| 24       | 204     | 2024-03-01 14:00:00 | app_open   | S004       | NULL        |\n| 25       | 204     | 2024-03-01 14:05:00 | scroll     | S004       | 600         |\n| 26       | 204     | 2024-03-01 14:08:00 | scroll     | S004       | 700         |\n| 27       | 204     | 2024-03-01 14:10:00 | click      | S004       | NULL        |\n| 28       | 204     | 2024-03-01 14:12:00 | app_close  | S004       | NULL        |\n+----------+---------+---------------------+------------+------------+-------------+\n</pre>\n\n<p><strong>Output:</strong></p>\n\n<pre class=\"example-io\">\n+------------+---------+--------------------------+--------------+\n| session_id | user_id | session_duration_minutes | scroll_count |\n+------------+---------+--------------------------+--------------+\n| S001       | 201     | 35                       | 6            |\n+------------+---------+--------------------------+--------------+\n</pre>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li><strong>Session S001 (User 201)</strong>:\n\n\t<ul>\n\t\t<li>Duration: 10:00:00 to 10:35:00 = 35 minutes (more than 30)&nbsp;</li>\n\t\t<li>Scroll events: 6 (at least 5)&nbsp;</li>\n\t\t<li>Click events: 0</li>\n\t\t<li>Click-to-scroll ratio: 0/6 = 0.00 (less than 0.20)&nbsp;</li>\n\t\t<li>Purchases: 0 (no purchases)&nbsp;</li>\n\t\t<li>S001 is a zombie session (meets all criteria)</li>\n\t</ul>\n\t</li>\n\t<li><strong>Session S002 (User 202)</strong>:\n\t<ul>\n\t\t<li>Duration: 11:00:00 to 11:20:00 = 20 minutes (less than 30)&nbsp;</li>\n\t\t<li>Has a purchase event&nbsp;</li>\n\t\t<li>S002 is&nbsp;not a zombie session&nbsp;</li>\n\t</ul>\n\t</li>\n\t<li><strong>Session S003 (User 203)</strong>:\n\t<ul>\n\t\t<li>Duration: 12:00:00 to 13:00:00 = 60 minutes (more than 30)&nbsp;</li>\n\t\t<li>Scroll events: 5 (at least 5)&nbsp;</li>\n\t\t<li>Click events: 1</li>\n\t\t<li>Click-to-scroll ratio: 1/5 = 0.20 (not less than 0.20)&nbsp;</li>\n\t\t<li>Purchases: 0 (no purchases)&nbsp;</li>\n\t\t<li>S003 is&nbsp;not a zombie session (click-to-scroll ratio equals 0.20, needs to be less)</li>\n\t</ul>\n\t</li>\n\t<li><strong>Session S004 (User 204)</strong>:\n\t<ul>\n\t\t<li>Duration: 14:00:00 to 14:12:00 = 12 minutes (less than 30)&nbsp;</li>\n\t\t<li>Scroll events: 2 (less than 5)&nbsp;</li>\n\t\t<li>S004&nbsp; is not a zombie session&nbsp;</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p>The result table is ordered by scroll_count in descending order, then by session_id in ascending order.</p>\n</div>\n",
    "difficulty": "Hard",
    "likes": 23,
    "dislikes": 2,
    "isPaidOnly": false,
    "sampleTestCase": "{\"headers\":{\"app_events\":[\"event_id\",\"user_id\",\"event_timestamp\",\"event_type\",\"session_id\",\"event_value\"]},\"rows\":{\"app_events\":[[1,201,\"2024-03-01 10:00:00\",\"app_open\",\"S001\",null],[2,201,\"2024-03-01 10:05:00\",\"scroll\",\"S001\",500],[3,201,\"2024-03-01 10:10:00\",\"scroll\",\"S001\",750],[4,201,\"2024-03-01 10:15:00\",\"scroll\",\"S001\",600],[5,201,\"2024-03-01 10:20:00\",\"scroll\",\"S001\",800],[6,201,\"2024-03-01 10:25:00\",\"scroll\",\"S001\",550],[7,201,\"2024-03-01 10:30:00\",\"scroll\",\"S001\",900],[8,201,\"2024-03-01 10:35:00\",\"app_close\",\"S001\",null],[9,202,\"2024-03-01 11:00:00\",\"app_open\",\"S002\",null],[10,202,\"2024-03-01 11:02:00\",\"click\",\"S002\",null],[11,202,\"2024-03-01 11:05:00\",\"scroll\",\"S002\",400],[12,202,\"2024-03-01 11:08:00\",\"click\",\"S002\",null],[13,202,\"2024-03-01 11:10:00\",\"scroll\",\"S002\",350],[14,202,\"2024-03-01 11:15:00\",\"purchase\",\"S002\",50],[15,202,\"2024-03-01 11:20:00\",\"app_close\",\"S002\",null],[16,203,\"2024-03-01 12:00:00\",\"app_open\",\"S003\",null],[17,203,\"2024-03-01 12:10:00\",\"scroll\",\"S003\",1000],[18,203,\"2024-03-01 12:20:00\",\"scroll\",\"S003\",1200],[19,203,\"2024-03-01 12:25:00\",\"click\",\"S003\",null],[20,203,\"2024-03-01 12:30:00\",\"scroll\",\"S003\",800],[21,203,\"2024-03-01 12:40:00\",\"scroll\",\"S003\",900],[22,203,\"2024-03-01 12:50:00\",\"scroll\",\"S003\",1100],[23,203,\"2024-03-01 13:00:00\",\"app_close\",\"S003\",null],[24,204,\"2024-03-01 14:00:00\",\"app_open\",\"S004\",null],[25,204,\"2024-03-01 14:05:00\",\"scroll\",\"S004\",600],[26,204,\"2024-03-01 14:08:00\",\"scroll\",\"S004\",700],[27,204,\"2024-03-01 14:10:00\",\"click\",\"S004\",null],[28,204,\"2024-03-01 14:12:00\",\"app_close\",\"S004\",null]]}}",
    "codeSnippets": [
      {
        "lang": "MySQL",
        "langSlug": "mysql",
        "code": "# Write your MySQL query statement below\n"
      },
      {
        "lang": "MS SQL Server",
        "langSlug": "mssql",
        "code": "/* Write your T-SQL query statement below */\n"
      },
      {
        "lang": "PostgreSQL",
        "langSlug": "postgresql",
        "code": "-- Write your PostgreSQL query statement below\n"
      },
      {
        "lang": "Oracle",
        "langSlug": "oraclesql",
        "code": "/* Write your PL/SQL query statement below */\n"
      },
      {
        "lang": "Pandas",
        "langSlug": "pythondata",
        "code": "import pandas as pd\n\ndef find_zombie_sessions(app_events: pd.DataFrame) -> pd.DataFrame:\n    "
      }
    ],
    "topicTags": [],
    "stats": "{\"totalAccepted\": \"2.8K\", \"totalSubmission\": \"5.6K\", \"totalAcceptedRaw\": 2795, \"totalSubmissionRaw\": 5627, \"acRate\": \"49.7%\"}",
    "similarQuestions": "[]",
    "stats_parsed": {
      "totalAccepted": "2.8K",
      "totalSubmission": "5.6K",
      "totalAcceptedRaw": 2795,
      "totalSubmissionRaw": 5627,
      "acRate": "49.7%"
    },
    "similarQuestions_parsed": []
  },
  "discussions_preview": [],
  "fetched_at": "2025-11-25T14:57:13.678988Z"
}